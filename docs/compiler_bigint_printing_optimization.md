# 编译器性能优化：BigInt 打印速度提升

## 1. 问题背景
在计算并打印超大整数（如 Fibonacci(10,000,000)）时，程序在输出阶段出现严重卡顿甚至假死。
**原因**：原有的打印逻辑采用“逐位取模”法。即不断对 BigInt 进行 `num % 10` 和 `num / 10` 操作来获取每一位十进制数字。由于 BigInt 除法是 $O(N)$ 复杂度的操作（$N$ 为 BigInt 内部数组长度），提取 $M$ 个十进制位的总复杂度为 $O(M \times N)$。对于极大的 $M$，这种 $O(M^2)$ 级别的开销非常巨大，且每次只处理 1 位数字，效率极低。

## 2. 优化方案：压位除法 (Base $10^{19}$)
利用 `uint64` 能存储的最大 10 的幂是 $10^{19}$ (`18,446,744,073,709,551,616` > `10,000,000,000,000,000,000`) 这一特性，将除法基数从 `10` 提升至 `10^{19}`。

### 核心变更
1.  **除数变更**：
    *   旧：`const TEN = 10`
    *   新：`const TEN_19 = 10000000000000000000` (19 个 0)

2.  **处理逻辑**：
    *   每次对 BigInt 进行除法运算时，计算 `num / 10^{19}` 和 `num % 10^{19}`。
    *   余数不再是一个 `0-9` 的数字，而是一个 `0 ~ 10^{19}-1` 的巨大整数，包含 **19 位十进制信息**。
    *   将这些“19 位数据块”存入临时数组。

3.  **打印逻辑**：
    *   逆序遍历数据块数组。
    *   **首个数据块**（最高位块）：使用 `%llu` 正常打印（不补零）。
    *   **后续数据块**：使用 `%019llu` 打印，确保不足 19 位的数字在前面补零，保证位数对齐。

### 代码修改点 (`src/meteor/compiler/builtins.py`)
*   `define_print_bigint` 函数中：
    *   引入全局常量 `BIGINT_DIV_CONST_1E19` 用于优化除法。
    *   除法循环中的基数 `TEN` 替换为 `TEN_19`。
    *   增加 `fmt_dec_first` (`%llu`) 和 `fmt_dec_pad` (`%019llu`) 两个格式化字符串。
    *   在最终打印循环中，增加判断是否为首个块的逻辑分支，分别调用不同的 `printf` 格式。

## 3. 性能影响
*   **理论提升**：除法运算次数减少为原来的 **1/19**。
*   **实际效果**：对于千万级 Fibonacci 数的打印时间从“无限等待”缩短至可接受范围。大幅降低了 I/O 准备阶段的 CPU 消耗。
